





\section{Solving the Households problem} \label{sec:Sol_method}
This section reviews the dynamic programming problem of the households briefly introduced earlier, and how to solve it numerically. The state variables of the household's optimization problem are $\left(k, \beta_{i},e_{i},a_{i},\Lambda\right)$, where $\Lambda=\left(w,r^a,q\right)$ denotes aggregate variables. The general bellman equation for a given employment state $k$ is:
\begin{align*}
V_{t}^{k}\left(\beta,e_{t},a_{t},\Lambda_{t}\right)=\max_{c_{t},a_{t},\ell_{t}}\frac{c_{t}^{1-\frac{1}{\sigma}}}{1-\frac{1}{\sigma}}+\beta\mathbb{E}_{t}V_{t+1}^{k}\left(\beta,e_{t+1},a_{t+1},\Lambda_{t+1}\right),
\end{align*}
subject to the constraints:
\begin{gather*}
c_{i,t}+a_{i,t}=\left(1+r^a\right)a_{i,t-1}+I^k_{i,t}+T_{i,t}-\tau\left(I^k_{i,t}\right) \\
 a_{t}\geq\underline{a} 
\end{gather*}
The continuation value depends on current employment status. If the household is currently employed we have:
\begin{gather*}
\mathbb{E}_{t}\left[V_{t+1}^{k}\left(\beta,e_{t+1},a_{t+1},\Lambda_{t+1}\right)\left|k_{t}=N\right.\right]=\mathbb{E}_{t}\left[\left(1-\delta\left(1-q_{t+1}\right)\right)V_{t+1}^{k=N}\right.\left.+\delta\left(1-q_{t+1}\right)V_{t+1}^{k=U}\right]
\end{gather*}
The continuation value of unemployment is weighted with the probability $\delta\left(1-q\right)$, which states that with probability $\delta$ the job is destroyed, and with probability $1-q$ a new job is not obtained. The continuation value of employment is weighted with the complementary probability. Similarly, the continuation value if unemployed in period $t$ is:
\begin{gather*}
\mathbb{E}_{t}\left[V_{t+1}^{k}\left(\beta,e_{t+1},a_{t+1},\Lambda_{t+1}\right)\left|k_{t}=U\right.\right]=\mathbb{E}_{t}\left[q_{t+1}V_{t+1}^{k=N}\right.\left.+\left(1-q_{t+1}\right)V_{t+1}^{k=U}\right]
\end{gather*}


\subsection{Euler Equations}
I here derive the Euler equations governing intertemporal consumption/savings decision of the households. I do so using the Lagrange method, though they can as easily be derived from the above value functions by application of the Envelope theorem. The Lagrangian of an agent in state $k$ is: 
\begin{align*}
\mathcal{L}^{k}=\mathbb{E}_{t}\sum_{t}  \beta^{t}\frac{c_{t}^{1-\frac{1}{\sigma}}}{1-\frac{1}{\sigma}}
+\lambda_{t}^{1}\left[\left(1+r^a_{t}\right)a_{t-1}+I_{t}^{k}+T_{t}-\tau\left(I_{t}^{k}\right)- c_{t}-a_{t}\right]+\lambda_{t}^{2}\left[a_{t}-\underline{a}\right]
\end{align*}

The first-order/Karush-Kuhn-Tucker conditions are: 
\begin{align*}
&\frac{\partial\mathcal{L}^{k}}{\partial c_{t}}=\beta^{t}c_{t}^{-\frac{1}{\sigma}}-\lambda_{t}^{1} =0 \\
&\frac{\partial\mathcal{L}^{k}}{\partial a_{t}}=-\lambda_{t}^{1}+\mathbb{E}_{t}\lambda_{t+1}^{1}R_{t+1} +\lambda_{t}^{2}= 0 \\
%&\frac{\partial\mathcal{L}^{k}}{\partial\ell_{t}}  =-\varphi\ell^{\frac{1}{\varphi}}+\lambda_{t}^{1}w_{t}e_{t}\left(1-\tau'\left(w_{t}\ell_{t}e_{i,t}\right)\right)=0, \quad \textit{if} \quad k_t = N \\
&\lambda_{t}^{2}\left[a_{t}-\underline{a}\right]=0
\end{align*}
where $R_{t+1}=1+r^a_{t+1}$. If the borrowing constraint is violated ($a_{t}<\underline{a}$) then $\lambda_{t}^{2}\neq0$ and consumption/savings follows from the budget constraint with $a_{t}=\underline{a}$. If the borrowing constraint is slack then $\lambda_{t}^{2}=0$, and optimal consumption is determined by the Euler equation: 
\begin{gather*}
c_{t}^{-\frac{1}{\sigma}}=\beta\mathbb{E}_{t}R_{t+1}c_{t+1}^{-\frac{1}{\sigma}}
\end{gather*}
This general expression holds for agents in all states $k$. However, the exact expectation differs since it depends on today's states. The specific Euler equations for each of the employment states are:
\begin{gather*}
\left(c_{t}^{k=N}\right)^{-\frac{1}{\sigma}}=\beta\mathbb{E}_{t}R_{t+1}\left[\left(1-\delta\left(1-q_{t+1}\right)\right)\left(c_{t+1}^{k=N}\right)^{-\frac{1}{\sigma}}+\delta\left(1-q_{t+1}\right)\left(c_{t+1}^{k=U}\right)^{-\frac{1}{\sigma}}\right] \\
\left(c_{t}^{k=U}\right)^{-\frac{1}{\sigma}}=\beta\mathbb{E}_{t}R_{t+1}\left[q_{t+1}\left(c_{t+1}^{k=N}\right)^{-\frac{1}{\sigma}}+(1-q_{t+1})\left(c_{t+1}^{k=U}\right)^{-\frac{1}{\sigma}}\right], 
\end{gather*}
where the expectation is taken with respect to idiosyncratic earnings risk $e_{i,t+1}$. 
%The first-order condition for labor supply (which applies only to employed households) is:
%\begin{gather*}
%\ell^{\frac{1}{\varphi}}=c_{t}^{-\frac{1}{\sigma}}w_{t}e_{i,t}\frac{\left(1-\tau'\left(w_{t}\ell_{i,t}e_{i,t}\right)\right)}{\varphi\left(1+\tau^{VAT}\right)}
%\end{gather*}


%\subsection{Wealth Effects}
%The current formulation imply that working hours $\ell_{t}$ are affected by wealth effects through the marginal utility of consumption. Since consumption tends to be procyclical this effect pushes hours towards being countercyclical, which is at odds with empirical evidence. One solution is to assume an instantaneous utility function of the form $u\left(c_{t}-G\left(\ell_{t}\right)\right)$ as in \citet{greenwood1988investment} , which implies that the marginal rate of substitution depends only on hours. \citet{gali2012unemployment} opt for a different solution: They include an "endogenous preference shifter" in the utility function, which potentially allow for wealth effects in the short run. Their estimated DSGE model imply the presence of wealth effects in the short run, but only marginally. Since it simplifies the numerical implementation significantly, I assume no wealth effects at all \textit{outside of steady-state} as follows: Let $\varphi=\varphi^{\ell}\varphi_{t}^{c}$ where $\varphi^{\ell}$ measures the disutiltiy of labor and $\varphi_{t}^{c}=c_{t}^{-\frac{1}{\sigma}}$ such that:
%\begin{gather*}
%\ell^{\frac{1}{\varphi}}=w_{t}e_{i,t}\frac{\left(1-\tau'\left(w_{t}\ell_{i,t}e_{i,t}\right)\right)}{\varphi^{\ell}\left(1+\tau^{c}\right)}
%\end{gather*}
%This is the special case of Gali et. al. where (in their notation) $\upsilon=1$. 



\subsection{The Endogenous Grid Method}  \label{HH_problem_numerical_sol}
To solve the dynamic programming problem numerically I apply the endogenous grid method (EGM) of \citet{carroll2006method}. EGM is preferable to, for instance, the standard method of value function iteration since it avoids root-finding operations by exploiting the analytical first-order conditions. The problem is solved as follows. Define grids for the state variables $\beta,e_{t},a_{t}$ as:
\begin{gather*}
\beta\in\left\{ \beta^{1},\beta^{2},...,\beta^{\#_{\beta}}\right\}  \\
e_{t}\in\left\{ e^{1},e^{2},...,e^{\#_{e}}\right\}  \\
a_{t}\in\left\{ a^{1},a^{2},...,a^{\#_{a}}\right\} 
\end{gather*}
The grid for $\beta$ is calibrated by fitting the wealth distribution to data. The grid for $e_t$ is set to reflect the variation in earnings - see the calibration section for details. The grid for $a_t$ is chosen to to reflect the interval in which households can realistically accumulate assets given the calibration of the economy. The lower bound of this grid follows from the borrowing constraint, while the upper bound is somewhat arbitrarily chosen (100 currently). The number of points in each grid are $\#_{\beta}=5,\#_{e}=11,\#_{a}=300$ so the state space consist of $5\cdot11\cdot200=11.000$ points for each employment state.   \\
The solution procedure works as follows for each employment state $\left\{ N,U\right\}$. Given an initial guess for the marginal value function $V_{a,t+1}\left(\beta,e_{t},a_{t},\Lambda_{t}\right)\equiv\frac{\partial}{\partial a_{t}}V_{t+1}\left(\beta,e_{t},a_{t},\Lambda_{t}\right)$, conduct the following steps:
\begin{enumerate}
    \item Combining the Euler equation and the envelope theorem implies $c_{t}^{-\frac{1}{\sigma}}\left(\beta,e_{t},a_{t},\Lambda_{t}\right)=\beta\mathbb{E}_{t}RV_{a,t+1}\left(\beta,e_{t},a_{t},\Lambda_{t}\right)$.\\ Compute this as: $c_{t}^{-\frac{1}{\sigma}}\left(\beta,e_{t},a_{t},\Lambda_{t}\right)=\beta R_{t+1}\sum_{e^{'}}^{\#_{e}}\mathcal{D}\left(e_{t}^{'}\left|e_{t}\right.\right)V_{a,t+1}\left(\beta,e_{t},a_{t},\Lambda_{t}\right)$, where $\mathcal{D}\left(e_{t}^{'}\left|e_{t}\right.\right)$ is the probability of transitioning to state $e'$ from state $e$. 
    
    \item Invert the marginal utility of consumption to obtain optimal consumption at the grid points : $\tilde{c}_{t}\left(\beta,e_{t},a_{t},\Lambda_{t}\right)=\left[c_{t}^{-\frac{1}{\sigma}}\left(\beta,e_{t},a_{t},\Lambda_{t}\right)\right]^{-\sigma}$.
    \item Calculate the endogenous grid by first defining cash-on-hand as \\ $m\left(\beta,e_{t},a_{t},\Lambda_{t}\right)=\tilde{c}_{t}\left(\beta,e_{t},a_{t},\Lambda_{t}\right) +a_{t}$. Shift optimal consumption to the previous period asset grid $a_{t-1}$ by interpolating $\tilde{c}_{t}\left(\beta,e_{t},a_{t},\Lambda_{t}\right)$ against $m\left(\beta,e_{t},a_{t},\Lambda_{t}\right)$ and evaluating at $\left(1+r\right)a+I_{i,t}^{k}+T_{i,t}-\tau\left(I_{i,t}^{k}\right)$ to obtain $c^{*}\left(\beta,e_{t},a_{t},\Lambda_{t}\right)$. 
%    \item Calculate labor supply by solving $\ell^{\frac{1}{\varphi}}=\tilde{c}_{t}_{t}^{-\frac{1}{\sigma}}w_{t}e_{i,t}\frac{\left(1-\tau'\left(w_{t}\ell_{i,t}e_{i,t}\right)\right)}{1+\tau^{VAT}}$.
    %\item Calculate consumption as $c^{*}\left(\beta,e_{t},a_{t},\Lambda_{t}\right)=m_{t}-a^{*}\left(\beta,e_{t},a_{t},\Lambda_{t}\right)$ for $\ell$. 
    
    \item Check whether borrowing constraints bind. If $a^{*}<\underline{a}$ set $a^{*}=\underline{a}$ and recalculate consumption as $c^{*}\left(\beta,e_{t},a_{t},\Lambda_{t}\right)=m_{t}$. 
    
    \item Calculate the marginal value of assets for further backwards iteration. This is done for each employment state:
    \begin{gather*}
        V_{a,t}^{k=N}\left(\beta,e_{t},a_{t},\Lambda_{t}\right)=\left(1-\delta\left(1-q_{t}\right)\right)c^{*,k=N}\left(\beta,e_{t},a_{t},\Lambda_{t}\right)^{-\frac{1}{\sigma}}+\delta\left(1-q_{t}\right)c^{*,k=U}\left(\beta,e_{t},a_{t},\Lambda_{t}\right)^{-\frac{1}{\sigma}}\\
        V_{a,t}^{k=U}\left(\beta,e_{t},a_{t},\Lambda_{t}\right)=q_{t}c^{*,k=N}\left(\beta,e_{t},a_{t},\Lambda_{t}\right)^{-\frac{1}{\sigma}}+\left(1-q_{t}\right)c^{*,k=U}\left(\beta,e_{t},a_{t},\Lambda_{t}\right)^{-\frac{1}{\sigma}}
    \end{gather*}

\end{enumerate}
Implementing this in an infinite horizon setting involves iteration (ie. repeating steps 1-6) from the initial guess until the difference $\left|c_{t+1}^{*}\left(\beta,e_{t},a_{t},\Lambda_{t}\right)-c_{t}^{*}\left(\beta,e_{t},a_{t},\Lambda_{t}\right)\right|$ is less than $\epsilon=1\times10^{-8}$ for all $c^{*}$ in the grid, afterwards which the problem is assumed to have converged.  

The earnings process $e_t$ is assumed to follow an AR(1) process in logarithms:
\begin{align*}
\log e_{t}=\rho\log e_{t-1}+\sigma^{e}\varepsilon, \qquad \varepsilon\backsim\mathcal{N}\left(0,1\right) 
\end{align*}
This implies that $e_t$ has mean 1, and follows a log-normal distribution. The process is discretized as a Markov chain using Rouwenhorst's method (\citet{rouwenhorstk}) with $n^e=11$ points. The discretization results in a vector of states $e$ of size $n^e$, a stochastic transition matrix $\mathcal{D}^{e}$ of size $n^{e}\times n^{e}$. I let $\mathcal{D}^{e}\left(e^{i},e^{j}\right)$ denote the probability of transitioning from state $e^i$ to $e^j$. Iterating on the transition matrix yields the ergodic distribution vector $d^{e}$ (of size $1\times n^{e}$), where each entry is the share of households in a given state. Since the process has mean 1 we have $d^{e}\cdot e'=1$. \\
The distribution of discount factors follows is assumed to lie in the interval $\left[\bar{\beta}-\Delta^{\beta},\bar{\beta}+\Delta^{\beta}\right]$ with $\bar{\beta}$ being the mean discount factor and $\Delta^{\beta}$ measuring the dispersion. The elements in the interval are uniformly distributed, but the weight $d^{\beta}$ (i.e. share of population that has the associated discount factor) included on each element is also estimated. \\
%The distribution of discount factors follows a log-normal distribution with mean $\overline{\beta}$ and standard error $\sigma^{\beta}$. The process is discretized with $n^\beta=5$ points and state vector $\beta$. The parameters of the distribution are estimated using the method of simulated moments. The targeted moments are the wealth level (given by $K+B$), and the wealth shares of the bottom 50\%, middle 40\% and the top 10 \%. \\
The individual distributions of households over the two exogenous states $e,\beta$ are obtained as explained above. The distribution of households over the endogenous state $a$ is obtained through iteration. Assume first the initial distribution $\mathcal{D}_{0}\left(\beta^{k},e^{i},k^{l},a^{j}\right)=\frac{d^{\beta}\left(\beta^{k}\right)d^{e}\left(e^{i}\right)d^{N}\left(k^{l}\right)}{n^{a}}$ (probability of being in state $\beta^{k}$, $e^{i}$ and $k^{l}$ is $d^{e}\left(\beta^{k}\right)d^{e}\left(e^{i}\right)d^{N}\left(k^{l}\right)$, and assume an initial uniform distribution across assets). Given a Markovian matrix for earnings $\mathcal{D}^{e}\left(e^{i},e^{i'}\right)$ and employment states\footnote{The transitional matrix for employment is given by $\mathcal{D}_{t}^{N}=\left[\begin{array}{cc}
1-\delta\left(1-q_{t+1}\right) & q_{t+1}\\
\delta\left(1-q_{t+1}\right) & 1-q_{t+1}
\end{array}\right]$.} $\mathcal{D}^{N}\left(k^{i},k^{i'}\right)$ the probability of transitioning from state $h=\left(i,l\right)$ to $h'=\left(i',l'\right)$ is the Kronecker product of the two, $\mathcal{D}^{T}\left(h,h'\right)=\mathcal{D}^{e}\left(e^{i},e^{i'}\right)\otimes\mathcal{D}^{N}\left(k^{l},k^{l'}\right)$. To obtain the distribution over asset apply the law of motion:
\begin{gather*}
\mathcal{D}_{t+1}\left(\beta^{k},e^{i},k^{l},a^{j}\right)=\sum_{h'}\mathcal{D}^{T}\left(h,h'\right)\sum_{j'=1}^{n^{a}}\mathcal{D}_{0}\left(\beta^{k},e^{i},k^{l},a^{j}\right)\omega\left(a^{*}\left(\beta^{k},e^{i},k^{l},a^{j'}\right),a^{j}\right),  
\end{gather*}
where the function $\omega\left(a^{*}\left(\beta^{k},e^{i},k^{l},a^{j'}\right),a^{j}\right)$ interpolates the associated grid point and its two closest neighbors. when optimal asset choices are between grid points:
\begin{gather*}
\omega\left(a^{*},\underline{a},\tilde{a},\overline{a}\right)=1\left\{ a^{*}\in\left[\underline{a},\overline{a}\right]\right\} \begin{cases}
\begin{array}{c}
\frac{\overline{a}-a^{*}}{\overline{a}-\tilde{a}},\\
\frac{a^{*}-\underline{a}}{\overline{a}-\underline{a}},
\end{array} & \begin{array}{c}
a\geq\tilde{a}\\
a<\tilde{a}
\end{array}\end{cases}
\end{gather*}
with $\underline{a}=a^{\max\left\{ j-1,1\right\} }$ and $\overline{a}=a^{\min\left\{ j+1,n^{a}\right\} }$. Forward iteration of the law of motion until convergence gives the ergodic, steady-state distribution $\mathcal{D}_{ss}$. %Outside of steady-state the law of motion can be 
 



\section{Numerical Implementation} \label{sec:SHADE_method}
I solve the dynamic problem of the household as described in section \ref{HH_problem_numerical_sol}. I solve for the steady-state using a combination of analytical and numerical methods. In particular, some blocks of the model can be solved analytically conditional on calibration and targets (the firm block for instance), while other blocks require numerical solvers. Furthermore, since I use heterogeneity in discount factors to match the wealth distribution the Household block and asset market equilibrium along with government budget is calibrated.    

\subsection{General Equilibrium Jacobians}
To determine dynamic responses outside of the steady-state I apply the sequence-Space method proposed by \citet{auclert2019using}. This is in contrast with the often used Krussel-Smith algorithm (\citet{krusell1998income}) and the algorithm of \citet{reiter2009solving}, who both solves for the (approximate) dynamic equilibrium path in the presence of aggregate shocks. To gain intuition for the sequence-space method, consider aggregate assets:\footnote{This outline follows \textit{A Note on Solving Heterogenous Agent General
Equilibrium Models} by Jeppe Druedahl and Christoffer Jessen Weissert.}
\begin{gather*}
\int a^{*}\left(k,\beta,e_{t},a_{t-1}\right)d  \mathcal{D}_{t},
\end{gather*}
which equals optimal assets $a^*$ (i.e. the policy that solves the households problem) aggregate over the various states. The budget constraint implies that the policy $a^*$ is a function of the paths $\left\{ r_{s},w_{s},N_{s}\right\} _{s\geq t}$, which in turn together with an initial stationary distribution $D_0^{ss}$ determines the path $\left\{ D_{s}\right\} _{s\geq t}$. From the firms FOC we can determine $\left\{ N_{s}\right\} _{s\geq t}$ from $\left\{ r_{s},w_{s}\right\} _{s\geq t}$, which are then sufficient to write aggregate assets in sequence space as: 
\begin{gather*}
\mathcal{A}_{t}\left(\left\{ r_{s},w_{s}\right\} \right)=\int a^{*}\left(k,\beta,e_{t},a_{t-1}\right)dD_{t},
\end{gather*}
which maps the aggregate asset sequence into the aggregate sequences for wages and the interest rate. To derive impulse responses, let us for a minute assume we are interested in the response following an exogenous shock to productivity $z_t$, of which $r,w$ are functions. The model solution then solves the equation: 
\begin{gather*}
H_{t}\left(\boldsymbol{A},\mathbf{Z},D_{0}\right)\equiv\mathcal{A}_{t}\left(\left\{ r\left(Z_{s},A_{s-1}\right),w\left(Z_{s},A_{s-1}\right)\right\} _{s\geq0},D_{0}\right)-A_{t}=0,\quad t=0,1,\ldots
\end{gather*}
where $\boldsymbol{A}=\left(A_{0},A_{1},...\right)$ and $\boldsymbol{Z}=\left(Z_{0},Z_{1},...\right)$ are the time-stacked vectors of assets and productivity. Stacking the equilibrium condition over time yields: 
\begin{gather*}
\boldsymbol{H}\left(\boldsymbol{A},\mathbf{Z},D_{0}\right)=0
\end{gather*}
Totally differentiating this condition gives $\boldsymbol{H_{A}}d\boldsymbol{A}+\boldsymbol{H_{Z}}d\boldsymbol{Z}=0$, where $\boldsymbol{H_{A}}$ is the Jacobian of $H$ w.r.t. $\boldsymbol{A}$ defined by:
\begin{gather*}
\boldsymbol{H_{A}}=\left[\begin{array}{ccc}
\frac{\partial H_{0}}{\partial A_{0}} & \frac{\partial H_{0}}{\partial A_{1}} & \cdots \\
\frac{\partial H_{1}}{\partial A_{0}} & \ddots & \ddots \\
\vdots & \ddots & \ddots
\end{array}\right]
\end{gather*}
and similarly for $\boldsymbol{H_Z}$. Restating the above equation gives the impulse of $\boldsymbol{A}$ w.r.t $\boldsymbol{Z}$:
\begin{gather*}
d\boldsymbol{A}=-\boldsymbol{H_{A}}^{-1}\boldsymbol{H_{Z}}d\boldsymbol{Z}
\end{gather*}
To calculate the impulse response of $\boldsymbol{A}$ only the jacobians $\boldsymbol{H_{A}},\boldsymbol{H_{Z}}$ need to be determined. Applying the chain rule to $\boldsymbol{H}\left(\boldsymbol{A},\mathbf{Z},D_{0}\right)=0$ yields:
\begin{gather*}
\boldsymbol{H}_{K}=\mathcal{J}^{\mathcal{K}, r} \mathcal{J}^{r, K}+\mathcal{J}^{\mathcal{K}, w} \mathcal{J}^{w, K}-\boldsymbol{I}, \\
\boldsymbol{H}_{Z}=\mathcal{J}^{\mathcal{K},r}\mathcal{J}^{r,Z}+\mathcal{J}^{\mathcal{K},w}\mathcal{J}^{w,Z},
\end{gather*}
where $\mathcal{J}^{\mathcal{K},r}$ is the Jacobian of $\mathcal{K}$ w.r.t. $r$ (and similarly for the other Jacobian), and $\boldsymbol{I}$ is the identity matrix. Using the Jacobians the impulse for any variable $x$ in response to $Z$ can be calculated as:
\begin{gather*}
d\boldsymbol{X}=\boldsymbol{G}^{X,Z}d\boldsymbol{Z}, \\
\boldsymbol{G}^{X,Z}=\mathcal{J}^{X,Z}+\mathcal{J}^{X,K}\frac{d\boldsymbol{K}}{d\boldsymbol{Z}}
\end{gather*}
In the remainder of the thesis I apply mostly the first-order approximations to compute impulse responses due to the sizeable computational gain compared with the estimation of non-liner impulses. The main limitation to the linear approximation is their invariance to shock sizes and signs. Furthermore, since investment and price adjustment costs are quadratic these are zero in the first-order approximation of the model. I show in the appendix that using linear approximations has little impact on my results.  





\subsection{DAGs}
The majority of \citet{auclert2019using} presents various tools and methods to speed up the computation of the Jacobians. One such method is the use of formulating the underlying model in $\bold H$ as a \textit{directed acyclic graph} (DAG). Imagine two blocks of equations $b, b'$ and that $b$ takes inputs from $b'$, $b'\rightarrow b$. If all the blocks of equations in the model $\bold H$ has a weak ordering $b^1, ...,b^N$ such that the inputs to block $b^i$ is the output of blocks $b^1,...b^{i-1}$ the blocks of the model form a DAG. \\

The computational gain from this is straightforward: One can start by calculating the Jacobian of $b^1$, and if the model forms a DAG, $b^2$ will depend on the outputs of $b^1$, and hence the Jacobian of $b^2$ can be calculated. Continued application of this reasoning eventually yields all jacobians. The trick from here in \citet{auclert2019using} is to view this procedure as a mapping between a set of unknowns to a set of targets that must be zero. For the model in this paper the DAG representation is presented in figure \ref{DAG_main}.   

\begin{figure}[H]
\input{mainmatter/plots/DAGs/DAG_main.tex}
\caption{Directed acyclic graph of the main model. } \label{DAG_main}
\end{figure}

For complicated models where a DAG is not readily constructable, the framework allows for smaller DAG blocks to be constructed first. Thus, the blocks "Labor Block", "Firms \& Pricing Block", and "Asset Block" are themselves DAGs that are solved through forward accumulation first.  






 